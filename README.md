# Customer_segmentation_Analysis
using the mall dataset
# -*- coding: utf-8 -*-
"""customer_segmentation.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1mOn8pgqZ1jnqIjisWgrXIbe6kgU6Gos0
"""

import numpy as np
import pandas as pd

import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
from sklearn.cluster import KMeans

df=pd.read_csv("/content/Mall_Customers.csv")
df

df.shape

df.describe()

df.info()

df.isnull().sum()

# dropping unwanted column
df.drop('CustomerID',axis=1,inplace=True)

sns.countplot(x=df['Gender'])

x=1
plt.figure(figsize=(10,5))
for i in ['Age','Annual Income (k$)',"Spending Score (1-100)"]:
    plt.subplot(1,3,x)
    sns.histplot(x=df[i],kde=True)
    x+=1

from sklearn.preprocessing import LabelEncoder
encoder = LabelEncoder()
df["Gender"] = encoder.fit_transform(df["Gender"])

df = df[['Annual Income (k$)','Spending Score (1-100)']]
df

from sklearn.preprocessing import MinMaxScaler
scaler = MinMaxScaler()
df = scaler.fit_transform(df)

WCSS = []
for i in range(1,11):
    kmeans = KMeans(n_clusters=i, init='k-means++',n_init=10, random_state=42)
    kmeans.fit(df)
    WCSS.append(kmeans.inertia_)

sns.set()
sns.scatterplot(x=range(1,11),y=WCSS)
plt.plot(range(1,11), WCSS, c='red')
plt.xlabel("The number of clusters")
plt.ylabel("WCSS")
plt.title("ELbow Point Graph")
plt.show()

kmeans = KMeans(n_clusters=5, init='k-means++',n_init=10, random_state=42)

# assign a label for each data point based on their cluster
Predictions = kmeans.fit_predict(df)
Predictions

plt.figure(figsize=(8,8))
plt.scatter(df[Predictions==0,0], df[Predictions==0,1],s=50, c='green', label='cluster 1')
plt.scatter(df[Predictions==1,0], df[Predictions==1,1],s=50, c='red', label='cluster 2')
plt.scatter(df[Predictions==2,0], df[Predictions==2,1],s=50, c='yellow', label='cluster 3')
plt.scatter(df[Predictions==3,0], df[Predictions==3,1],s=50, c='black', label='cluster 4')
plt.scatter(df[Predictions==4,0], df[Predictions==4,1],s=50, c='blue', label='cluster 5')

plt.scatter(kmeans.cluster_centers_[:,0], kmeans.cluster_centers_[:,1], s=100, c='cyan', label='centroids')
plt.xlabel("Annual Income")
plt.ylabel("Spending score")
plt.title("customer segments")
plt.show()
